# ============================================================================
# CivicQ Backend - Production Environment Configuration
# ============================================================================
# IMPORTANT: Copy this file to .env.production and fill in secure values
# Command: cp .env.production.example .env.production
#
# Security Notes:
# - Never commit .env.production to version control
# - Use strong, randomly generated passwords and keys
# - Rotate secrets regularly
# - Use managed services for production databases
# ============================================================================

# ============================================================================
# ENVIRONMENT
# ============================================================================
ENVIRONMENT=production
DEBUG=false

# ============================================================================
# SECURITY (CRITICAL - MUST CHANGE)
# ============================================================================
# Generate with: openssl rand -hex 32
SECRET_KEY=CHANGEME-CRITICAL-generate-with-openssl-rand-hex-32

# JWT Configuration
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=1440
REFRESH_TOKEN_EXPIRE_DAYS=7

# ============================================================================
# CORS & ALLOWED ORIGINS (REQUIRED)
# ============================================================================
ALLOWED_ORIGINS=https://civicq.com,https://www.civicq.com,https://app.civicq.com
# Comma-separated list - must match your frontend URLs exactly

# ============================================================================
# APPLICATION URLs (REQUIRED)
# ============================================================================
FRONTEND_URL=https://civicq.com
BACKEND_URL=https://api.civicq.com

# ============================================================================
# DATABASE (PostgreSQL with pgvector)
# ============================================================================
# Production: Use managed database (AWS RDS, Google Cloud SQL, etc.)
DATABASE_URL=postgresql://civicq_prod:CHANGEME_DB_PASSWORD@your-rds-endpoint.region.rds.amazonaws.com:5432/civicq
DATABASE_ECHO=false

# ============================================================================
# REDIS (ElastiCache, Cloud Memorystore, etc.)
# ============================================================================
# Production: Use managed Redis with password
REDIS_URL=redis://:CHANGEME_REDIS_PASSWORD@your-redis-endpoint.cache.amazonaws.com:6379/0

# ============================================================================
# CELERY (Background Tasks)
# ============================================================================
CELERY_BROKER_URL=redis://:CHANGEME_REDIS_PASSWORD@your-redis-endpoint.cache.amazonaws.com:6379/1
CELERY_RESULT_BACKEND=redis://:CHANGEME_REDIS_PASSWORD@your-redis-endpoint.cache.amazonaws.com:6379/1

# ============================================================================
# S3 / OBJECT STORAGE (REQUIRED)
# ============================================================================
S3_BUCKET=civicq-media-production
S3_REGION=us-west-2
S3_ACCESS_KEY=CHANGEME_AWS_ACCESS_KEY
S3_SECRET_KEY=CHANGEME_AWS_SECRET_KEY
S3_ENDPOINT=  # Leave empty for AWS S3

# CDN Configuration
CDN_URL=https://d1234567890.cloudfront.net
# CloudFront or other CDN URL for serving media

# ============================================================================
# VIDEO PROCESSING
# ============================================================================
MAX_VIDEO_DURATION_SECONDS=180
VIDEO_TIME_LIMIT_COUNCIL=90
VIDEO_TIME_LIMIT_MAYOR=120
VIDEO_TIME_LIMIT_MEASURE=180

# ============================================================================
# AI/ML SERVICES (REQUIRED for AI features)
# ============================================================================
# OpenAI for transcription
OPENAI_API_KEY=sk-CHANGEME_OPENAI_API_KEY

# Anthropic for question analysis
ANTHROPIC_API_KEY=sk-ant-CHANGEME_ANTHROPIC_API_KEY
ANTHROPIC_MODEL=claude-sonnet-4-5-20250929
ENABLE_AI_FEATURES=true

# Embeddings (sentence-transformers runs locally)
EMBEDDING_MODEL=sentence-transformers/all-MiniLM-L6-v2
SIMILARITY_THRESHOLD=0.85

# ============================================================================
# SMS SERVICE - TWILIO (REQUIRED for phone verification)
# ============================================================================
TWILIO_ACCOUNT_SID=CHANGEME_TWILIO_ACCOUNT_SID
TWILIO_AUTH_TOKEN=CHANGEME_TWILIO_AUTH_TOKEN
TWILIO_PHONE_NUMBER=+1234567890

# ============================================================================
# EMAIL SERVICE - SENDGRID (RECOMMENDED for production)
# ============================================================================
SENDGRID_API_KEY=SG.CHANGEME_SENDGRID_API_KEY
EMAIL_FROM=noreply@civicq.com

# Alternative: SMTP
SMTP_HOST=smtp.sendgrid.net
SMTP_PORT=587
SMTP_USER=apikey
SMTP_PASSWORD=${SENDGRID_API_KEY}

# ============================================================================
# OAUTH PROVIDERS (OPTIONAL)
# ============================================================================
# Google OAuth
GOOGLE_CLIENT_ID=CHANGEME_GOOGLE_CLIENT_ID.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=CHANGEME_GOOGLE_CLIENT_SECRET

# Facebook OAuth
FACEBOOK_CLIENT_ID=CHANGEME_FACEBOOK_CLIENT_ID
FACEBOOK_CLIENT_SECRET=CHANGEME_FACEBOOK_CLIENT_SECRET

# ============================================================================
# LOGGING & MONITORING
# ============================================================================
LOG_LEVEL=INFO
# Options: DEBUG, INFO, WARNING, ERROR, CRITICAL

# Sentry Error Tracking (HIGHLY RECOMMENDED)
SENTRY_DSN=https://CHANGEME@o123456.ingest.sentry.io/789012
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1

# ============================================================================
# RATE LIMITING
# ============================================================================
RATE_LIMIT_QUESTIONS_PER_DAY=10
RATE_LIMIT_VOTES_PER_HOUR=100

# ============================================================================
# CONTENT MODERATION
# ============================================================================
AUTO_MODERATE=true
TOXICITY_THRESHOLD=0.7

# ============================================================================
# EXTERNAL APIs (OPTIONAL)
# ============================================================================
GOOGLE_CIVIC_API_KEY=CHANGEME_GOOGLE_CIVIC_API_KEY
VOTE_AMERICA_API_KEY=CHANGEME_VOTE_AMERICA_API_KEY
BALLOTPEDIA_API_KEY=CHANGEME_BALLOTPEDIA_API_KEY

# ============================================================================
# FEATURE FLAGS
# ============================================================================
ENABLE_VIDEO_RECORDING=true
ENABLE_REBUTTALS=true
ENABLE_SOURCE_ATTACHMENTS=true
ENABLE_VIEWPOINT_CLUSTERING=true

# ============================================================================
# SESSION MANAGEMENT
# ============================================================================
SESSION_EXPIRE_SECONDS=86400
REMEMBER_ME_EXPIRE_SECONDS=2592000

# ============================================================================
# VERIFICATION
# ============================================================================
VERIFICATION_METHOD=sms
VERIFICATION_CODE_EXPIRE_MINUTES=15

# ============================================================================
# BACKUP CONFIGURATION (for backup scripts)
# ============================================================================
BACKUP_S3_BUCKET=civicq-backups-production
BACKUP_RETENTION_DAYS=30

# ============================================================================
# PRODUCTION DEPLOYMENT CHECKLIST
# ============================================================================
# Before going live, ensure:
#
# [X] SECRET_KEY is unique and secure (32+ characters)
# [X] All passwords are strong and unique
# [X] DATABASE_URL points to managed production database
# [X] REDIS_URL points to managed production Redis
# [X] S3_BUCKET is created with proper permissions
# [X] CDN_URL is configured with CloudFront/Cloudflare
# [X] SENDGRID_API_KEY is set up for email delivery
# [X] TWILIO credentials are configured for SMS
# [X] SENTRY_DSN is set up for error tracking
# [X] SSL certificates are installed and valid
# [X] ALLOWED_ORIGINS matches production frontend URLs
# [X] Database backups are automated
# [X] Monitoring and alerting are configured
# [X] Load testing has been performed
# [X] Security audit has been completed
# [X] GDPR/privacy compliance is verified
# ============================================================================
